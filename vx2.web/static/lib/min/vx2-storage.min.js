/*! vx2-storage - v2.4.7 - 2016-12-08
* http://www.csii.com.cn/hercules/v
* Copyright (c) 2016 CSII; Licensed : BSD */
"use strict";!function(a,b){"function"==typeof define&&define.amd?define(["angular"],b):a.hasOwnProperty("angular")?b(a.angular):"object"==typeof exports&&(module.exports=b(require("angular")))}(this,function(a){function b(b){return function(){var c="vStorage-";this.setKeyPrefix=function(a){if("string"!=typeof a)throw new TypeError("[vStorage] - "+b+"Provider.setKeyPrefix() expects a String.");c=a};var d=a.toJson,e=a.fromJson;this.setSerializer=function(a){if("function"!=typeof a)throw new TypeError("[vStorage] - "+b+"Provider.setSerializer expects a function.");d=a},this.setDeserializer=function(a){if("function"!=typeof a)throw new TypeError("[vStorage] - "+b+"Provider.setDeserializer expects a function.");e=a},this.get=function(a){return e(window[b].getItem(c+a))},this.set=function(a,e){return window[b].setItem(c+a,d(e))},this.$get=["$rootScope","$window","$log","$timeout","$document",function(f,g,h,i,j){function k(a){var b;try{b=g[a]}catch(c){b=!1}if(b&&"localStorage"===a){var d="__"+Math.round(1e7*Math.random());try{localStorage.setItem(d,d),localStorage.removeItem(d)}catch(c){b=!1}}return b}var l,m,n=c.length,o=k(b)||(h.warn("This browser does not support Web Storage!"),{setItem:a.noop,getItem:a.noop,removeItem:a.noop}),p={$default:function(b){for(var c in b)a.isDefined(p[c])||(p[c]=a.copy(b[c]));return p.$sync(),p},$reset:function(a){for(var b in p)"$"===b[0]||delete p[b]&&o.removeItem(c+b);return p.$default(a)},$set:function(b,d){return delete p[b]&&o.removeItem(c+b),a.isDefined(p[b])||(p[b]=a.copy(d)),p.$sync(),p},$delete:function(a){return delete p[a]&&o.removeItem(c+a),p.$sync(),p},$sync:function(){for(var a,b=0,d=o.length;d>b;b++)(a=o.key(b))&&c===a.slice(0,n)&&(p[a.slice(n)]=e(o.getItem(a)))},$apply:function(){var b;if(m=null,!a.equals(p,l)){b=a.copy(l),a.forEach(p,function(e,f){a.isDefined(e)&&"$"!==f[0]&&(o.setItem(c+f,d(e)),delete b[f])});for(var e in b)o.removeItem(c+e);l=a.copy(p)}}};return p.$sync(),l=a.copy(p),f.$watch(function(){m||(m=i(p.$apply,100,!1))}),g.addEventListener&&g.addEventListener("storage",function(b){if(b.key){var d=j[0];d.hasFocus&&d.hasFocus()||c!==b.key.slice(0,n)||(b.newValue?p[b.key.slice(n)]=e(b.newValue):delete p[b.key.slice(n)],l=a.copy(p),f.$apply())}}),g.addEventListener&&g.addEventListener("beforeunload",function(){p.$apply()}),p}]}}return a=a&&a.module?a:window.angular,a.module("vStorage",[]).provider("$localStorage",b("localStorage")).provider("$sessionStorage",b("sessionStorage"))}),function(a,b,c){var d=b.module("vStorage");d.provider("$submitConfig",{submitErrProcess:null,setSubmitErrProcess:function(a){this.submitErrProcess=a},submitCompileProcess:null,setSubmitCompileProcess:function(a){this.submitCompileProcess=a},submitBeforeProcess:null,setSubmitBeforeProcess:function(a){this.submitBeforeProcess=a},$get:["$log",function(a){var b=this;return{doSubmitErrProcess:function(a,c,d){b.submitErrProcess&&b.submitErrProcess(a,c,d)},doSubmitCompileProcess:function(a){b.submitCompileProcess&&b.submitCompileProcess(a)},doSubmitBeforeProcess:function(a){b.submitBeforeProcess&&b.submitBeforeProcess(a)}}}]}),d.directive("ngSubmit",["$parse","$rootScope","$submitConfig","$log",function(a,c,d,e){return{restrict:"A",compile:function(c,f){var g=a(f.ngSubmit,null,!0);return function(c,h){var i=h.controller("form");c[f.name].$getData=function(){function c(a){for(var b,c=[],d=0;d<a.length;d++)isValidItem(a[d])&&(b=copy(a[d]),c.push(b));return c}function d(b,c,d){var e=a(c+"=tmp");e(b,{tmp:d})}function e(a){return b.isUndefined(a)||""===a||null===a||a!==a}return function(a){var f={},g={};return a&&(g=parentForm.$getData()),b.forEach(i,function(a){if(a&&a.$name&&!a.$parentModel){var b=a.$modelValue;if(e(b))return;if(a.$virtual&&(b=c(b),0===b.length))return;d(f,a.$name,b)}}),b.extend({},g,f)}}(),d.doSubmitCompileProcess(c),h.on("submit",function(a){d.doSubmitBeforeProcess(c);for(var b=c[f.name],h=f.language||c.language||"zh_CN",i=f.$$element[0],j=0;j<i.length;j++){var k=i[j];-1!=="inputselect".indexOf(k.tagName.toLowerCase())&&k.blur();var l=k.getAttribute("validate")||!0;if("BUTTON"!==k.nodeName&&"false"!==l){var m={};m.zh_CN={required:k.getAttribute("required-message")||"不能为空",min:k.getAttribute("min-message")||"最小值:"+k.getAttribute("v-min"),max:k.getAttribute("max-message")||"最大值:"+k.getAttribute("v-max"),minlength:k.getAttribute("minlength-message")||"最小长度:"+k.getAttribute("v-minlength"),maxlength:k.getAttribute("maxlength-message")||"最大长度:"+k.getAttribute("v-maxlength"),pattern:k.getAttribute("pattern-message")||"格式不正确","default":"格式不正确"},m.en={required:k.getAttribute("required-message_en")||"required invalid",min:k.getAttribute("min-message_en")||"min value:"+k.getAttribute("v-min"),max:k.getAttribute("max-message_en")||"max value:"+k.getAttribute("v-max"),minlength:k.getAttribute("minlength-message_en")||"min length:"+k.getAttribute("v-minlength"),maxlength:k.getAttribute("maxlength-message_en")||"max length:"+k.getAttribute("v-maxlength"),pattern:k.getAttribute("pattern-message_en")||"pattern invalid","default":"pattern invalid"};var n=k.name||k.id,o="en"===h?"["+(k.getAttribute("title_en")||n)+"]  ":"["+(k.getAttribute("title_zh")||k.title||n)+"]  ";for(var p in b.$error)for(var q=0;q<b.$error[p].length;q++)if(n==b.$error[p][q].$name){var r="en"===h?p+"-message_en":p+"-message",s=m[h][p]||k.getAttribute(r)||m[h]["default"];return d.doSubmitErrProcess(o,s,c),void e.error(o+s)}}}var t=function(){g(c,{$event:a})};c.$apply(t)})}}}}])}(window,window.vx),function(a,b,c){var d=b.module("vStorage");d.provider("$contextConfig",{$sessionStorageEnable:!1,setSessionStorageEnable:function(a){this.$sessionStorageEnable=a},$get:["$log",function(a){var b=this;return{sessionStorageEnable:b.$sessionStorageEnable}}]}),d.factory("$context",["$rootScope","$location","$sessionStorage","$contextConfig",function(c,d,e,f){var g=function(){var a={};return f.sessionStorageEnable?e.$default&&(a.setData=function(a,b){var c={};c[a]=b,e.$set("_data",c)},a.setJson=function(a){e.$set("_data",a)},a.setNextScope=function(a,b){e.$set("_dataS",a),b?e.$set("_LikeRoute",b):e.$delete("_LikeRoute")},a.getNextScope=function(){return e._dataS},a.getLikeRoute=function(){return e._LikeRoute},a.clearNextScope=function(){e.$delete("_dataS")},a.clearLikeRoute=function(){e.$delete("_LikeRoute")},a.pushJson=function(a){e.$set("_data",b.extend(e._data||{},a))},a.getData=function(a){return e._data[a]},a.getJson=function(){return e._data},a.removeData=function(a){e._data&&delete e._data[a]},a.clear=function(){e.$delete("_data")}):(a._data={},a.setData=function(b,c){a._data[b]=c},a.setJson=function(b){a._data=b},a.setNextScope=function(b,c){a._dataS=b,c?a._LikeRoute=c:delete a._LikeRoute},a.getNextScope=function(){return a._dataS},a.getLikeRoute=function(){return a._LikeRoute},a.clearNextScope=function(){delete a._dataS},a.clearLikeRoute=function(){delete a._LikeRoute},a.pushJson=function(c){b.extend(a._data,c)},a.getData=function(b){return a._data[b]},a.getJson=function(){return a._data},a.removeData=function(b){delete a._data[b]},a.clear=function(){a._data={}},a.containsKey=function(b){return a._data[b]?!0:!1}),a}();return c.$context=g,c.$on("$viewContentLoadedStart",function(c,e){if(g.getNextScope()&&"{}"!=b.toJson(g.getNextScope())){var f=g.getLikeRoute(),h=d.path();try{(!f||h.indexOf(f)>=0)&&b.extend(e,g.getNextScope())}catch(i){a.history.back(-1)}finally{(!f||h.indexOf(f)<0)&&g.clearNextScope()}}}),g}])}(window,vx);